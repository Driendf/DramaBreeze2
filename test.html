<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Reproductor Anime Profesional</title>
<style>
:root{
  --bg:#0f1720; --panel:#0b1220; --muted:#98a1ad; --accent:#00d084;
  --glass: rgba(255,255,255,0.03); --shadow: 0 6px 18px rgba(2,6,23,0.6);
  font-family: Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
}
*{box-sizing:border-box;margin:0;padding:0}
body{background:var(--bg);color:#e6eef6}
.container{display:flex;flex-direction:column;min-height:100vh;width:100%;padding:0px}
.player-wrap{display:flex;flex-direction:row;gap:16px;max-width:1400px;margin:0 auto;width:100%}
.main{flex:1;background:var(--panel);padding:16px;border-radius:14px;box-shadow:var(--shadow);display:flex;flex-direction:column;gap:12px}
.screen{position:relative;border-radius:12px;overflow:hidden;background:#000;padding-top:56.25%}
.screen iframe{position:absolute;top:0;left:0;width:100%;height:100%;border:0}
.controls{display:flex;align-items:center;gap:10px;flex-wrap:wrap}
.btn{background:var(--glass);border:1px solid rgba(255,255,255,0.03);padding:8px 14px;border-radius:10px;cursor:pointer;color:var(--muted);transition:.2s}
.btn:hover{background:rgba(0,208,132,0.1)}
.btn.primary{background:linear-gradient(90deg,var(--accent),#32c6a1);color:#062528;border:none}
.meta{margin-left:auto;font-size:14px;color:#fff;font-weight:500}
#serverPanel{display:flex;flex-direction:column;gap:8px;margin-top:10px}
.server-row{display:flex;align-items:center;gap:8px;flex-wrap:wrap}
.server-row strong{width:60px;color:#fff;min-width:60px}
.server-row button{padding:4px 8px;border-radius:6px;border:1px solid rgba(255,255,255,0.2);background:rgba(255,255,255,0.03);color:#e6eef6;cursor:pointer;transition:.2s}
.server-row button.active{background:var(--accent);color:#062528;border:none}
.server-row button:hover{background:rgba(0,208,132,0.2)}
.sidebar{width:300px;background:var(--panel);padding:12px;border-radius:14px;overflow:auto;display:flex;flex-direction:column;gap:8px}
.sidebar-header{font-size:16px;font-weight:600;color:#fff;padding-bottom:6px;border-bottom:1px solid rgba(255,255,255,0.1)}
.group-btn{background:var(--glass);border:none;padding:6px 10px;border-radius:8px;color:var(--muted);cursor:pointer;transition:.2s;margin-top:6px}
.group-btn:hover{background:rgba(255,255,255,0.08)}
.group-menu{display:none;flex-direction:column;max-height:180px;overflow-y:auto;margin-bottom:10px;border:1px solid rgba(255,255,255,0.1);border-radius:8px}
.group-menu button{padding:6px 10px;margin:2px;background:var(--glass);border:none;border-radius:6px;color:var(--muted);cursor:pointer;transition:.2s}
.group-menu button.active{background:var(--accent);color:#062528}
.ep-list{display:grid;grid-template-columns:repeat(auto-fill,minmax(50px,1fr));gap:6px;padding-top:10px;max-height:400px;overflow-y:auto}
.ep{background:var(--glass);padding:10px 0;border-radius:6px;text-align:center;cursor:pointer;color:var(--muted);transition:.2s;font-size:13px}
.ep:hover{background:rgba(0,208,132,0.1)}
.ep.active{outline:2px solid rgba(0,208,132,0.5);color:#fff;background:#112622}
@media(max-width:960px){
  .player-wrap{flex-direction:column}
  .sidebar{width:100%;order:-1;max-height:250px}
  #serverPanel{flex-direction:column}
}
</style>
</head>
<body>
<div class="container">
<div class="player-wrap">
  <div class="main">
    <div class="screen" id="playerScreen">
      <iframe id="iframePlayer" src="" allowfullscreen></iframe>
    </div>
    <div class="controls">
      <button class="btn" id="prevBtn">◀ Anterior</button>
      <button class="btn primary" id="playBtn">Recargar</button>
      <button class="btn" id="nextBtn">Siguiente ▶</button>
      <div class="meta">Episodio <strong id="epNumber">1</strong></div>
    </div>
    <div id="serverPanel"></div>
  </div>
  <aside class="sidebar">
    <div class="sidebar-header">Lista de Episodios</div>
    <button class="group-btn active" id="groupBtn">1-20 ▼</button>
    <div class="group-menu" id="groupMenu"></div>
    <div class="ep-list" id="epList"></div>
  </aside>
</div>
</div>

<script>
const iframe = document.getElementById('iframePlayer');
const epList = document.getElementById('epList');
const groupBtn = document.getElementById('groupBtn');
const groupMenu = document.getElementById('groupMenu');
const epNumber = document.getElementById('epNumber');
const serverPanel = document.getElementById('serverPanel');

const episodes = [];
for(let i=1;i<=22;i++){
  episodes.push({
    id:i,
    title:"Episodio "+i,
    servers:{
      latino:{Mega:"https://mega.nz/embed/D3hnjLDb", YouTube:"https://youtube.com/embed/D3hnjLDb"},
      castellano:{Mega:"https://mega.nz/embed/D3hnjLDb"},
      sub:{Mega:"https://mega.nz/embed/D3hnjLDb"}
    }
  });
}

// Episodio 3 con servidores propios
episodes[2] = {
  id:3,
  title:"Episodio 3",
  servers:{
    latino:{Mega:"https://mega.nz/embed/TU_SERVER_LAT1", YouTube:"https://youtube.com/embed/TU_SERVER_LAT2"},
    castellano:{Mega:"https://mega.nz/embed/TU_SERVER_CAS1"},
    sub:{Mega:"https://www.mp4upload.com/embed-78kptpyotrle.html"}
  }
};

let current = 0;
let currentGroup = 0;

// Carga de episodio
function loadEpisode(index){
  current = index;
  epNumber.textContent = episodes[current].id;
  renderEpisodes(currentGroup);
  renderServerPanel();
  // Reproduce automáticamente el primer servidor disponible del primer idioma
  const firstLang = Object.keys(episodes[current].servers)[0];
  const firstServer = Object.values(episodes[current].servers[firstLang])[0];
  iframe.src = firstServer;
}

// Render lista de episodios
function renderEpisodes(groupIndex){
  epList.innerHTML = '';
  const start = groupIndex*20;
  const end = Math.min(start+20, episodes.length);
  for(let i=start;i<end;i++){
    const ep = episodes[i];
    const div = document.createElement('div');
    div.className = 'ep'+(i===current?' active':'');
    div.textContent = ep.id;
    div.addEventListener('click',()=>{ loadEpisode(i); });
    epList.appendChild(div);
  }
}

// Menu de grupos de 20 episodios
function renderGroupMenu(){
  groupMenu.innerHTML = '';
  const totalGroups = Math.ceil(episodes.length/20);
  for(let i=1;i<totalGroups;i++){
    const btn = document.createElement('button');
    btn.textContent = (i*20+1)+'-'+Math.min((i+1)*20, episodes.length);
    btn.addEventListener('click', ()=>{
      currentGroup = i;
      renderEpisodes(i);
      groupBtn.textContent = btn.textContent+' ▼';
      Array.from(groupMenu.querySelectorAll('button')).forEach(b=>b.classList.remove('active'));
      btn.classList.add('active');
      groupMenu.style.display='none';
    });
    groupMenu.appendChild(btn);
  }
}

groupBtn.addEventListener('click',()=>{ groupMenu.style.display = groupMenu.style.display==='flex'?'none':'flex'; });

// Render panel de servidores tipo SUB/LAT/CAST
function renderServerPanel(){
  serverPanel.innerHTML = '';
  const langOrder = ['sub','latino','castellano'];
  langOrder.forEach(lang=>{
    const servers = episodes[current].servers[lang];
    if(!servers) return;
    const row = document.createElement('div');
    row.className='server-row';
    const label = document.createElement('strong');
    label.textContent = lang.toUpperCase()+' :';
    row.appendChild(label);
    Object.entries(servers).forEach(([name,link])=>{
      const btn = document.createElement('button');
      btn.textContent = name;
      btn.addEventListener('click', ()=>{
        iframe.src = link;
        Array.from(row.querySelectorAll('button')).forEach(b=>b.classList.remove('active'));
        btn.classList.add('active');
      });
      row.appendChild(btn);
    });
    serverPanel.appendChild(row);
  });
}

// Botones de control
document.getElementById('prevBtn').addEventListener('click',()=>{if(current>0) loadEpisode(current-1)});
document.getElementById('nextBtn').addEventListener('click',()=>{if(current<episodes.length-1) loadEpisode(current+1)});
document.getElementById('playBtn').addEventListener('click',()=>{iframe.src=iframe.src});

renderEpisodes(currentGroup);
renderGroupMenu();
loadEpisode(current);
</script>
</body>
</html>

